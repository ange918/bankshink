<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulator de prêt - Shine BK</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .simulator-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark-blue);
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-blue);
        }
        
        .results-container {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--dark-blue) 100%);
            color: white;
            border-radius: 15px;
            display: none;
        }
        
        .results-container.show {
            display: block;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gold);
        }

        .application-form-container {
            display: none;
            margin-top: 40px;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.1);
        }

        .application-form-container.show {
            display: block;
        }

        .steps-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
        }

        .steps-indicator::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: #e0e0e0;
            z-index: -1;
        }

        .step {
            flex: 1;
            text-align: center;
            position: relative;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e0e0e0;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: 700;
            transition: all 0.3s;
        }

        .step.active .step-circle {
            background: var(--primary-blue);
            color: white;
        }

        .step.completed .step-circle {
            background: #00c853;
            color: white;
        }

        .step-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }

        .step.active .step-label {
            color: var(--primary-blue);
            font-weight: 600;
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .btn-prev, .btn-next {
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .btn-prev {
            background: #e0e0e0;
            color: #333;
        }

        .btn-prev:hover {
            background: #d0d0d0;
        }

        .btn-next {
            background: var(--primary-blue);
            color: white;
        }

        .btn-next:hover {
            background: var(--dark-blue);
        }

        .file-upload {
            border: 2px dashed #e0e0e0;
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload:hover {
            border-color: var(--primary-blue);
            background: #f5f5f5;
        }

        .toast-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 10000;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s ease-in-out;
            max-width: 400px;
            border-left: 5px solid;
        }

        .toast-notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast-notification.success {
            border-left-color: #00c853;
        }

        .toast-notification.error {
            border-left-color: #f44336;
        }

        .toast-notification i {
            font-size: 28px;
        }

        .toast-notification.success i {
            color: #00c853;
        }

        .toast-notification.error i {
            color: #f44336;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 700;
            margin-bottom: 5px;
            color: #333;
            font-size: 1rem;
        }

        .toast-message {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .toast-notification {
                top: 10px;
                right: 10px;
                left: 10px;
                max-width: calc(100% - 20px);
                padding: 15px 20px;
            }
        
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .steps-indicator {
                flex-wrap: wrap;
            }
            
            .simulator-container {
                padding: 25px 20px;
            }
            
            .application-form-container {
                padding: 25px 20px;
            }
            
            .result-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
                padding: 12px 0;
            }
            
            .result-item span:first-child {
                font-size: 0.9rem;
            }
            
            .result-value {
                font-size: 1.3rem;
            }
            
            .form-buttons {
                flex-direction: column-reverse;
                gap: 10px;
            }
            
            .btn-prev, .btn-next {
                width: 100%;
                padding: 14px 30px;
                font-size: 1rem;
            }
            
            .form-step h3 {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
        <header>
        <div class="header-top">
            <div class="container">
                <div class="contact-info">
                    <span><i class='bx bx-phone'></i> <span>+33 7 45 35 86 52</span></span>
                    <span><i class='bx bx-envelope'></i> <span>contact@shinebk.com</span></span>
                </div>            </div>
        </div>
        <div class="header-main">
            <div class="container">
                <a href="../index.html" class="logo">shine</a>
                <nav>
                    <ul>
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="a-propos.html">Over ons</a></li>
                        <li class="dropdown">
                            <a href="nos-offres.html">Onze aanbiedingen ▾</a>
                            <div class="dropdown-menu">
                                <a href="micro-credit.html">Persoonlijke microkrediet</a>
                                <a href="credit-etudijaart.html">Studentenlening</a>
                                <a href="credit-professionnel.html">Zakelijke lening</a>
                                <a href="credit-consommation.html">Consumptief krediet</a>
                                <a href="credit-express.html">Express krediet</a>
                                <a href="credit-immobilier.html">Hypotheek</a>
                                <a href="credit-agricole.html">Agrarisch krediet</a>
                                <a href="credit-digital.html">Digitaal krediet</a>
                                <a href="credit-automobile.html">Autolening</a>
                            </div>
                        </li>
                        <li><a href="contact.html">Contact</a></li>
                        <li><a href="simulateur.html" class="btn-primary">Simulator</a></li>
                    </ul>
                </nav>
                <button class="mobile-menu-toggle"><i class='bx bx-menu'></i></button>
            </div>
        </div>
    </header>


    <section class="hero" style="padding: 60px 0;">
        <div class="container">
            <div style="text-align: center;">
                <h1>Simulator de prêt</h1>
                <p>Calculez vos mensualités en quelques clics</p>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container">
            <div class="simulator-container">
                <h2 style="margin-bottom: 30px; color: var(--dark-blue);">Calculez votre prêt</h2>
                <form id="lojaarForm">
                    <div class="form-group">
                        <label for="lojaarType">Type de prêt</label>
                        <select id="lojaarType" required>
                            <option value="">Selecteer un type</option>
                            <option value="personnel">Persoonlijke microkrediet</option>
                            <option value="etudijaart">Studentenlening</option>
                            <option value="professionnel">Zakelijke lening</option>
                            <option value="consommation">Consumptief krediet</option>
                            <option value="express">Express krediet</option>
                            <option value="immobilier">Hypotheek</option>
                            <option value="agricole">Agrarisch krediet</option>
                            <option value="digital">Digitaal krediet</option>
                            <option value="automobile">Autolening</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="amount">Montant emprunté (€)</label>
                        <input type="number" id="amount" min="1000" max="500000" step="1000" value="50000" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="duration">Durée (maaarden)</label>
                        <input type="number" id="duration" min="12" max="360" step="12" value="120" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="rate">Taux d'intérêt jaarnuel (%)</label>
                        <input type="number" id="rate" min="0.1" max="20" step="0.1" value="3.5" required>
                    </div>
                    
                    <button type="submit" class="btn-primary" style="width: 100%; margin-top: 20px;">Berekenen</button>
                </form>
                
                <div id="results" class="results-container">
                    <h3 style="margin-bottom: 20px;">Résultats de votre simulation</h3>
                    <div class="result-item">
                        <span>Maandelijkse betaling</span>
                        <span class="result-value" id="monthly"></span>
                    </div>
                    <div class="result-item">
                        <span>Totale kosten van het krediet</span>
                        <span class="result-value" id="totalCost"></span>
                    </div>
                    <div class="result-item">
                        <span>Montant total à rembourser</span>
                        <span class="result-value" id="totalAmount"></span>
                    </div>
                    <div style="margin-top: 30px; text-align: center;">
                        <button onclick="showApplicationForm()" class="btn-gold" style="border: none; cursor: pointer;">Faire ma demande de crédit</button>
                    </div>
                </div>

                <div id="applicationForm" class="application-form-container">
                    <h2 style="margin-bottom: 30px; color: var(--dark-blue); text-align: center;">Faire ma demande de crédit</h2>
                    <p style="text-align: center; color: #666; margin-bottom: 40px;">Complétez votre dossier en 4 étapes simples. Vos données sont sécurisées et sauvegardées automatiquement.</p>
                    
                    <div class="steps-indicator">
                        <div class="step active" data-step="1">
                            <div class="step-circle">1</div>
                            <div class="step-label">Identité</div>
                        </div>
                        <div class="step" data-step="2">
                            <div class="step-circle">2</div>
                            <div class="step-label">Revenus & Charges</div>
                        </div>
                        <div class="step" data-step="3">
                            <div class="step-circle">3</div>
                            <div class="step-label">Projet & Documents</div>
                        </div>
                        <div class="step" data-step="4">
                            <div class="step-circle">4</div>
                            <div class="step-label">Récapitulatif</div>
                        </div>
                    </div>

                    <form id="creditApplicationForm">
                        <div class="form-step active" data-step="1">
                            <h3 style="margin-bottom: 25px; color: var(--primary-blue);">Vos informations personnelles</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="firstName">Prénom *</label>
                                    <input type="text" id="firstName" required>
                                </div>
                                <div class="form-group">
                                    <label for="lastName">Nom *</label>
                                    <input type="text" id="lastName" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="email">E-mail *</label>
                                    <input type="email" id="email" required>
                                </div>
                                <div class="form-group">
                                    <label for="phone">Telefoon *</label>
                                    <input type="tel" id="phone" placeholder="01 23 45 67 89" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="birthDate">Date de naissance *</label>
                                <input type="date" id="birthDate" required>
                            </div>
                            <div class="form-group">
                                <label for="address">Adres complète *</label>
                                <textarea id="address" rows="3" placeholder="Numéro, rue, code postal, ville" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; font-family: inherit; resize: vertical;"></textarea>
                            </div>
                        </div>

                        <div class="form-step" data-step="2">
                            <h3 style="margin-bottom: 25px; color: var(--primary-blue);">Revenus & Charges</h3>
                            <div class="form-group">
                                <label for="profession">Profession</label>
                                <input type="text" id="profession">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="monthlyIncome">Revenus mensuels nets (€)</label>
                                    <input type="number" id="monthlyIncome" min="0" step="100">
                                </div>
                                <div class="form-group">
                                    <label for="monthlyCharges">Charges mensuelles (€)</label>
                                    <input type="number" id="monthlyCharges" min="0" step="100">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="employmentType">Situation professionnelle</label>
                                <select id="employmentType">
                                    <option value="">Selecteer</option>
                                    <option value="cdi">CDI</option>
                                    <option value="cdd">CDD</option>
                                    <option value="independjaart">Indépendjaart</option>
                                    <option value="fonctionnaire">Fonctionnaire</option>
                                    <option value="retraite">Retraité</option>
                                    <option value="autre">Autre</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-step" data-step="3">
                            <h3 style="margin-bottom: 25px; color: var(--primary-blue);">Projet & Documents</h3>
                            <div class="form-group">
                                <label for="projectDescription">Description du projet</label>
                                <textarea id="projectDescription" rows="4" placeholder="Décrivez votre projet en quelques mots..." style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; font-family: inherit; resize: vertical;"></textarea>
                            </div>
                            
                            <div style="background: #e3f2fd; padding: 20px; border-radius: 8px; border-left: 4px solid var(--primary-blue); margin-bottom: 25px;">
                                <h4 style="color: var(--primary-blue); margin: 0 0 10px 0; font-size: 1.1rem;">
                                    <i class='bx bx-paperclip'></i> Téléversement des documents requis
                                </h4>
                                <p style="margin: 0; color: #666; font-size: 0.95rem;">Documents nécessaires à l'étude de votre dossier</p>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="idCardFront"><i class='bx bx-id-card'></i> Carte d'identité – Recto *</label>
                                    <input type="file" id="idCardFront" accept=".jpg,.jpeg,.png,.pdf" required style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                                    <p style="margin-top: 5px; font-size: 0.85rem; color: #666;">Formats acceptés: JPG, PNG, PDF</p>
                                </div>
                                <div class="form-group">
                                    <label for="idCardBack"><i class='bx bx-id-card'></i> Carte d'identité – Verso *</label>
                                    <input type="file" id="idCardBack" accept=".jpg,.jpeg,.png,.pdf" required style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                                    <p style="margin-top: 5px; font-size: 0.85rem; color: #666;">Formats acceptés: JPG, PNG, PDF</p>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="bankCardFront"><i class='bx bx-credit-card'></i> Carte bancaire – Recto *</label>
                                    <input type="file" id="bankCardFront" accept=".jpg,.jpeg,.png,.pdf" required style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                                    <p style="margin-top: 5px; font-size: 0.85rem; color: #666;">Formats acceptés: JPG, PNG, PDF</p>
                                </div>
                                <div class="form-group">
                                    <label for="bankCardBack"><i class='bx bx-credit-card'></i> Carte bancaire – Verso *</label>
                                    <input type="file" id="bankCardBack" accept=".jpg,.jpeg,.png,.pdf" required style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                                    <p style="margin-top: 5px; font-size: 0.85rem; color: #666;">Formats acceptés: JPG, PNG, PDF</p>
                                </div>
                            </div>
                        </div>

                        <div class="form-step" data-step="4">
                            <h3 style="margin-bottom: 25px; color: var(--primary-blue);">Récapitulatif de votre demande</h3>
                            <div style="background: #f5f5f5; padding: 30px; border-radius: 10px;">
                                <div class="result-item" style="border-color: #ddd;">
                                    <span><strong>Type krediet</strong></span>
                                    <span id="summaryLojaarType">-</span>
                                </div>
                                <div class="result-item" style="border-color: #ddd;">
                                    <span><strong>Montant</strong></span>
                                    <span id="summaryAmount">-</span>
                                </div>
                                <div class="result-item" style="border-color: #ddd;">
                                    <span><strong>Maandelijkse betaling</strong></span>
                                    <span id="summaryMonthly">-</span>
                                </div>
                                <div class="result-item" style="border-color: #ddd;">
                                    <span><strong>Volledige naam</strong></span>
                                    <span id="summaryName">-</span>
                                </div>
                                <div class="result-item" style="border-color: #ddd;">
                                    <span><strong>E-mail</strong></span>
                                    <span id="summaryE-mail">-</span>
                                </div>
                                <div class="result-item" style="border-color: #ddd; border-bottom: none;">
                                    <span><strong>Telefoon</strong></span>
                                    <span id="summaryPhone">-</span>
                                </div>
                            </div>
                            <div style="margin-top: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid var(--primary-blue);">
                                <p style="margin: 0; color: #1976d2;"><i class='bx bx-info-circle'></i> Votre demande sera traitée sous 24h. Vous recevrez une réponse par email.</p>
                            </div>
                        </div>

                        <div class="form-buttons">
                            <button type="button" class="btn-prev" onclick="previousStep()" style="display: none;">Précédent</button>
                            <button type="button" class="btn-next" onclick="nextStep()">Suivjaart</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Shine Bank</h3>
                    <p>Uw digitale bankpartner voor modern en veilig financieel beheer.</p>
                    <div class="social-links">
                        <a href="#"><i class='bx bxl-facebook'></i></a>
                        <a href="#"><i class='bx bxl-twitter'></i></a>
                        <a href="#"><i class='bx bxl-instagram'></i></a>
                        <a href="#"><i class='bx bxl-linkedin'></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Snelle links</h3>
                    <ul>
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="a-propos.html">Over ons</a></li>
                        <li><a href="nos-offres.html">Nos offres</a></li>
                        <li><a href="simulateur.html">Simulator</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Onze kredietaanbiedingen</h3>
                    <ul>
                        <li><a href="micro-credit.html">Persoonlijke microkrediet</a></li>
                        <li><a href="credit-etudijaart.html">Studentenlening</a></li>
                        <li><a href="credit-professionnel.html">Zakelijke lening</a></li>
                        <li><a href="credit-consommation.html">Consumptief krediet</a></li>
                        <li><a href="credit-express.html">Express krediet</a></li>
                        <li><a href="credit-immobilier.html">Hypotheek</a></li>
                        <li><a href="credit-agricole.html">Agrarisch krediet</a></li>
                        <li><a href="credit-digital.html">Digitaal krediet</a></li>
                        <li><a href="credit-automobile.html">Autolening</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <ul>
                        <li><i class='bx bx-map'></i> 123 Avenue des Champs-Élysées, Paris</li>
                        <li><i class='bx bx-phone'></i> <span>+33 7 45 35 86 52</span></li>
                        <li><i class='bx bx-envelope'></i> <span>contact@shinebk.com</span></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p><span>&copy; 2025 Shine Bank. Tous droits réservés.</span> | <a href="#" style="color: rgba(255,255,255,0.6);">Wettelijke kennisgeving</a> | <a href="#" style="color: rgba(255,255,255,0.6);">Privacybeleid</a></p>
            </div>
        </div>
    </footer>


    <script>
        let currentFormStep = 1;
        let lojaarData = {};

        document.getElementById('lojaarForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const amount = parseFloat(document.getElementById('amount').value);
            const duration = parseInt(document.getElementById('duration').value);
            const rate = parseFloat(document.getElementById('rate').value);
            const lojaarType = document.getElementById('lojaarType').value;
            
            const monthlyRate = rate / 100 / 12;
            const monthly = (amount * monthlyRate * Math.pow(1 + monthlyRate, duration)) / 
                           (Math.pow(1 + monthlyRate, duration) - 1);
            
            const totalAmount = monthly * duration;
            const totalCost = totalAmount - amount;

            lojaarData = {
                type: lojaarType,
                amount: amount,
                duration: duration,
                rate: rate,
                monthly: monthly,
                totalAmount: totalAmount,
                totalCost: totalCost
            };
            
            document.getElementById('monthly').textContent = monthly.toFixed(2) + ' €';
            document.getElementById('totalCost').textContent = totalCost.toFixed(2) + ' €';
            document.getElementById('totalAmount').textContent = totalAmount.toFixed(2) + ' €';
            
            document.getElementById('results').classList.add('show');
        });

        function showApplicationForm() {
            document.getElementById('applicationForm').classList.add('show');
            document.getElementById('applicationForm').scrollIntoView({ behavior: 'smooth' });
        }

        function validateStep1() {
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const birthDate = document.getElementById('birthDate').value;
            const address = document.getElementById('address').value.trim();
            
            // Clear previous error messages
            document.querySelectorAll('.error-message').forEach(el => el.remove());
            document.querySelectorAll('.form-group input, .form-group textarea').forEach(el => {
                el.style.borderColor = '#e0e0e0';
            });
            
            let isValid = true;
            const errors = [];
            
            // Check all required fields
            if (!firstName) {
                showFieldError('firstName', 'Le prénom est requis');
                isValid = false;
            }
            if (!lastName) {
                showFieldError('lastName', 'Le nom est requis');
                isValid = false;
            }
            if (!email) {
                showFieldError('email', 'L\'email est requis');
                isValid = false;
            } else if (!isValidEmail(email)) {
                showFieldError('email', 'Email invalide');
                isValid = false;
            }
            if (!phone) {
                showFieldError('phone', 'Le téléphone est requis');
                isValid = false;
            }
            if (!birthDate) {
                showFieldError('birthDate', 'La date de naissance est requise');
                isValid = false;
            } else {
                // Validate age (must be 18+)
                const age = calculateAge(birthDate);
                if (age < 18) {
                    showFieldError('birthDate', 'Vous devez avoir au moins 18 ans pour effectuer une demande de prêt');
                    isValid = false;
                }
            }
            if (!address) {
                showFieldError('address', 'L\'adresse est requise');
                isValid = false;
            }
            
            if (!isValid) {
                // Show general error message
                const generalError = document.createElement('div');
                generalError.className = 'error-message';
                generalError.style.cssText = 'background: #ffebee; color: #c62828; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #ff4d4d;';
                generalError.innerHTML = '<strong>⚠️ Veuillez remplir tous les champs avant de continuer.</strong>';
                document.querySelector('.form-step.active').insertBefore(generalError, document.querySelector('.form-step.active').firstChild);
            }
            
            return isValid;
        }
        
        function validateStep3() {
            const idFront = document.getElementById('idCardFront').files.length;
            const idBack = document.getElementById('idCardBack').files.length;
            const bankFront = document.getElementById('bankCardFront').files.length;
            const bankBack = document.getElementById('bankCardBack').files.length;
            
            // Clear previous error messages
            document.querySelectorAll('.error-message').forEach(el => el.remove());
            document.querySelectorAll('input[type="file"]').forEach(el => {
                if (el.id.startsWith('idCard') || el.id.startsWith('bankCard')) {
                    el.style.borderColor = '#e0e0e0';
                }
            });
            
            let isValid = true;
            
            if (!idFront) {
                showFieldError('idCardFront', 'Ce document est requis pour finaliser votre demande');
                isValid = false;
            }
            if (!idBack) {
                showFieldError('idCardBack', 'Ce document est requis pour finaliser votre demande');
                isValid = false;
            }
            if (!bankFront) {
                showFieldError('bankCardFront', 'Ce document est requis pour finaliser votre demande');
                isValid = false;
            }
            if (!bankBack) {
                showFieldError('bankCardBack', 'Ce document est requis pour finaliser votre demande');
                isValid = false;
            }
            
            if (!isValid) {
                // Show general error message at the top of step 3
                const generalError = document.createElement('div');
                generalError.className = 'error-message';
                generalError.style.cssText = 'background: #ffebee; color: #c62828; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #ff4d4d;';
                generalError.innerHTML = '<strong>⚠️ Veuillez téléverser tous les documents requis avant de continuer.</strong>';
                document.querySelector('.form-step.active').insertBefore(generalError, document.querySelector('.form-step.active').firstChild);
            }
            
            return isValid;
        }
        
        function showFieldError(fieldId, message) {
            const field = document.getElementById(fieldId);
            field.style.borderColor = '#ff4d4d';
            
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.style.cssText = 'color: #ff4d4d; font-size: 0.9rem; margin-top: 5px;';
            errorDiv.textContent = message;
            
            field.parentElement.appendChild(errorDiv);
        }
        
        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }
        
        function calculateAge(birthDate) {
            const today = new Date();
            const birth = new Date(birthDate);
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            
            return age;
        }

        function nextStep() {
            // Validate current step before proceeding
            if (currentFormStep === 1) {
                if (!validateStep1()) {
                    return; // Don't proceed if validation fails
                }
            }
            
            if (currentFormStep === 3) {
                if (!validateStep3()) {
                    return; // Don't proceed if validation fails
                }
            }
            
            if (currentFormStep < 4) {
                document.querySelectorAll('.form-step')[currentFormStep - 1].classList.remove('active');
                document.querySelectorAll('.step')[currentFormStep - 1].classList.remove('active');
                document.querySelectorAll('.step')[currentFormStep - 1].classList.add('completed');
                
                currentFormStep++;
                
                document.querySelectorAll('.form-step')[currentFormStep - 1].classList.add('active');
                document.querySelectorAll('.step')[currentFormStep - 1].classList.add('active');
                
                document.querySelector('.btn-prev').style.display = 'block';
                
                if (currentFormStep === 4) {
                    updateSummary();
                    document.querySelector('.btn-next').textContent = 'Soumettre';
                }
            } else {
                submitApplication();
            }
        }

        function previousStep() {
            if (currentFormStep > 1) {
                document.querySelectorAll('.form-step')[currentFormStep - 1].classList.remove('active');
                document.querySelectorAll('.step')[currentFormStep - 1].classList.remove('active');
                
                currentFormStep--;
                
                document.querySelectorAll('.form-step')[currentFormStep - 1].classList.add('active');
                document.querySelectorAll('.step')[currentFormStep - 1].classList.add('active');
                document.querySelectorAll('.step')[currentFormStep].classList.remove('completed');
                
                if (currentFormStep === 1) {
                    document.querySelector('.btn-prev').style.display = 'none';
                }
                
                document.querySelector('.btn-next').textContent = 'Suivjaart';
            }
        }

        function showToast(type, content) {
            const toast = document.createElement('div');
            toast.className = `toast-notification ${type}`;
            
            const icon = type === 'success' ? 'bx-check-circle' : 'bx-error-circle';
            
            toast.innerHTML = `
                <i class='bx ${icon}'></i>
                <div class="toast-content">
                    <div class="toast-title">${content.title}</div>
                    <div class="toast-message">${content.message}</div>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 4000);
        }

        function updateSummary() {
            const lojaarTypes = {
                'personnel': 'Persoonlijke microkrediet',
                'etudijaart': 'Studentenlening',
                'professionnel': 'Zakelijke lening',
                'consommation': 'Consumptief krediet',
                'express': 'Express krediet',
                'immobilier': 'Hypotheek',
                'agricole': 'Agrarisch krediet',
                'digital': 'Digitaal krediet',
                'automobile': 'Autolening'
            };

            document.getElementById('summaryLojaarType').textContent = lojaarTypes[lojaarData.type] || '-';
            document.getElementById('summaryAmount').textContent = lojaarData.amount.toFixed(2) + ' €';
            document.getElementById('summaryMonthly').textContent = lojaarData.monthly.toFixed(2) + ' €';
            document.getElementById('summaryName').textContent = 
                document.getElementById('firstName').value + ' ' + document.getElementById('lastName').value;
            document.getElementById('summaryE-mail').textContent = document.getElementById('email').value;
            document.getElementById('summaryPhone').textContent = document.getElementById('phone').value;
        }

        async function submitApplication() {
            // Final validation before submission - ensure documents are uploaded
            if (!validateStep3()) {
                const submitButton = document.querySelector('.btn-next');
                submitButton.disabled = false;
                alert('⚠️ Veuillez téléverser tous les documents requis avant de soumettre votre demande.');
                return;
            }
            
            const submitButton = document.querySelector('.btn-next');
            const originalText = submitButton.textContent;
            submitButton.disabled = true;
            submitButton.textContent = 'Envoi en cours...';
            
            const email = document.getElementById('email').value;
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const phone = document.getElementById('phone').value;
            const currentLjaarg = localStorage.getItem('preferredLjaarguage') || 'fr';
            
            // Créer FormData pour envoyer les données au PHP
            const formData = new FormData();
            formData.append('firstName', firstName);
            formData.append('lastName', lastName);
            formData.append('email', email);
            formData.append('phone', phone);
            formData.append('lojaarType', lojaarData.type);
            formData.append('amount', lojaarData.amount.toFixed(2) + ' €');
            formData.append('duration', lojaarData.duration + ' maaarden');
            formData.append('monthlyPayment', lojaarData.monthly.toFixed(2) + ' €');
            
            // Ajouter les fichiers uploadés
            const idCardFront = document.getElementById('idCardFront').files[0];
            const idCardBack = document.getElementById('idCardBack').files[0];
            const bankCardFront = document.getElementById('bankCardFront').files[0];
            const bankCardBack = document.getElementById('bankCardBack').files[0];
            
            if (idCardFront) formData.append('idCardFront', idCardFront);
            if (idCardBack) formData.append('idCardBack', idCardBack);
            if (bankCardFront) formData.append('bankCardFront', bankCardFront);
            if (bankCardBack) formData.append('bankCardBack', bankCardBack);
            
            try {
                const response = await fetch('/process_form.php', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const messages = {
                        fr: { title: 'Demande envoyée !', message: 'Vérifiez votre boîte mail. Notre équipe répondra sous 3 jours ouvrés.' },
                        en: { title: 'Request sent!', message: 'Check your mailbox. Our team will respond within 3 business days.' },
                        es: { title: '¡Solicitud enviada!', message: 'Revise su buzón. Nuestro equipo responderá en 3 días hábiles.' },
                        de: { title: 'Anfrage gesendet!', message: 'Überprüfen Sie Ihr Postfach. Unser Team jaartwortet innerhalb von 3 Werktagen.' },
                        it: { title: 'Richiesta inviata!', message: 'Controlla la tua casella. Il nostro team risponderà entro 3 giorni lavorativi.' },
                        et: { title: 'Taotlus saadetud!', message: 'Kontrollige oma postkasti. Meie meeskond vastab 3 tööpäeva jooksul.' },
                        lt: { title: 'Užklausa išsiųsta!', message: 'Patikrinkite savo pašto dėžutę. Mūsų komanda atsakys per 3 darbo dienas.' },
                        sk: { title: 'Žiadosť odosljaará!', message: 'Skontrolujte si poštovú schránku. Náš tím odpovie do 3 pracovných dní.' },
                        nl: { title: 'Ajaarvraag verzonden!', message: 'Controleer uw mailbox. Ons team reageert binnen 3 werkdagen.' }
                    };
                    showToast('success', messages[currentLjaarg] || messages['fr']);
                    setTimeout(() => location.reload(), 3000);
                } else {
                    throw new Error(result.message || 'Erreur lors de l\'envoi');
                }
            } catch (error) {
                console.error('Error:', error);
                const errorBerichts = {
                    fr: { title: 'Erreur d\'envoi', message: 'L\'email de confirmation n\'a pas pu être envoyé. Veuillez réessayer.' },
                    en: { title: 'Sending error', message: 'The confirmation email could not be sent. Please try again.' },
                    es: { title: 'Error de envío', message: 'No se pudo enviar el correo de confirmación. Inténtelo de nuevo.' },
                    de: { title: 'Sendefehler', message: 'Die Bestätigungs-E-Mail konnte nicht gesendet werden. Bitte versuchen Sie es erneut.' },
                    it: { title: 'Errore di invio', message: 'L\'email di conferma non è stata inviata. Riprova.' },
                    et: { title: 'Saatmise viga', message: 'Kinnituskirja ei sajaarud saata. Palun proovige uuesti.' },
                    lt: { title: 'Siuntimo klaida', message: 'Patvirtinimo el. laiško nepavyko išsiųsti. Bandykite dar kartą.' },
                    sk: { title: 'Chyba odosljaaria', message: 'Potvrdzovací e-mail sa nepodarilo odoslať. Skúste znova.' },
                    nl: { title: 'Verzendfout', message: 'De bevestigingsmail kon niet worden verzonden. Probeer het opnieuw.' }
                };
                showToast('error', errorBerichts[currentLjaarg] || errorBerichts['fr']);
                submitButton.disabled = false;
                submitButton.textContent = originalText;
            }
        }

        // Add file change indicators for document uploads
        function setupFileInputIndicator(inputId) {
            const input = document.getElementById(inputId);
            input.addEventListener('change', function(e) {
                const label = input.previousElementSibling;
                if (this.files && this.files.length > 0) {
                    const fileName = this.files[0].name;
                    const indicator = document.createElement('span');
                    indicator.style.cssText = 'color: #00c853; margin-left: 10px; font-size: 0.9rem;';
                    indicator.innerHTML = '<i class="bx bx-check-circle"></i> ' + fileName;
                    
                    // Remove existing indicator if jaary
                    const existing = label.querySelector('.file-indicator');
                    if (existing) existing.remove();
                    
                    indicator.className = 'file-indicator';
                    label.appendChild(indicator);
                    
                    // Change border color to green to show valid
                    input.style.borderColor = '#00c853';
                } else {
                    const existing = label.querySelector('.file-indicator');
                    if (existing) existing.remove();
                    input.style.borderColor = '#e0e0e0';
                }
            });
        }
        
        setupFileInputIndicator('idCardFront');
        setupFileInputIndicator('idCardBack');
        setupFileInputIndicator('bankCardFront');
        setupFileInputIndicator('bankCardBack');
        
        // Confirmation message for form enhancements
        console.log('✅ Mise à jour du formulaire de prêt (validation stricte + documents justificatifs) activée avec succès sur Shine Bank.');
    </script>
    <script src="../js/main.js"></script>
</body>
</html>
